<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skippable Video Ad Experiment</title>
    <style>
        #videoContainer {
            position: relative;
            width: 640px;
            height: 360px;
            margin: 0 auto;
        }
        #skipBtn {
            position: absolute;
            bottom: 55px;
            right: 20px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            cursor: pointer;
            display: none;
            border-radius: 10px;
            font-family: 'Arial', 'Helvetica', 'sans-serif';
        }
        #countdown {
            position: absolute;
            bottom: 55px;
            right: 20px;
            color: white;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            display: none;
            font-family: 'Arial', 'Helvetica', 'sans-serif';
        }
    </style>
</head>
<body>

<div id="videoContainer">
    <video id="mainVideo" width="640" height="360" controls>
        <source src="main2_video.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>
    <video id="adVideo" width="640" height="360" style="display: none;">
        <source src="instreamleft.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>
    <div id="countdown">5</div>
    <div id="skipBtn" onclick="skipAd()">Skip Ad</div>
</div>

<script>
    const mainVideo = document.getElementById('mainVideo');
    const adVideo = document.getElementById('adVideo');
    const skipBtn = document.getElementById('skipBtn');
    const countdown = document.getElementById('countdown');
    let adPlayed = false; // 広告が既に再生されたかどうかを追跡
    let counter = 5; // スキップまでの秒数

    // メインビデオの途中で広告を再生する
    mainVideo.addEventListener('timeupdate', () => {
        if (!adPlayed && mainVideo.currentTime >= 30) {  // 30秒で広告を挿入
            playAd();
        }
    });

    function playAd() {
        adPlayed = true;
        mainVideo.pause();  // メインビデオを一時停止
        adVideo.style.display = 'block';
        mainVideo.style.display = 'none';
        adVideo.play();

        // カウントダウン開始
        countdown.style.display = 'block';
        skipBtn.style.display = 'none'; // 初期状態ではスキップボタンを非表示

        const countdownInterval = setInterval(() => {
            counter--;
            countdown.textContent = counter;
            if (counter <= 0) {
                skipBtn.style.display = 'block';  // スキップボタンを表示
                countdown.style.display = 'none';  // カウントダウンを非表示
                clearInterval(countdownInterval);
            }
        }, 1000);

        adVideo.addEventListener('ended', () => {
            resumeMainVideo();
        });
    }

    function skipAd() {
        adVideo.pause();  // 広告ビデオを停止
        skipBtn.style.display = 'none';
        resumeMainVideo();
    }

    function resumeMainVideo() {
        adVideo.style.display = 'none';
        mainVideo.style.display = 'block';
        mainVideo.play();
    }
</script>

</body>
</html>
